(()=>{"use strict";class i{container=document.getElementById("container");cardsByDifficulty=[3,6,12];constructor(){this.checkGameStatus()}checkGameStatus(){"start"===window.game.status&&(this.renderScreen("template-difficulty"),this.difficultyForm=document.getElementById("difficulty-form"),this.difficultyForm.classList.remove("game__difficulty__hidden"))}renderScreen(i){const s=document.getElementById(i).content.cloneNode(!0);this.container.appendChild(s)}startGame(){this.difficultyForm.classList.add("game__difficulty__hidden"),window.game.status="game",this.renderScreen("template-game"),this.renderCard()}playAgain(){document.getElementById("card-field").innerHTML="",this.renderCard()}createCard(i,s,t,e){const c=()=>{const s=e+i;return document.getElementById(s)?s+"double":s};window.game.cards.push(c());const a=document.createDocumentFragment(),d=document.createElement("div");var g,n,m,r;g=d,n=i,m=e,r=c(),g.classList.add("game__card-wrapper"),g.dataset.dignity=n,g.dataset.suit=m,g.id=r,d.classList.add("flip"),setTimeout((()=>{d.classList.remove("flip")}),5e3);const u=document.createElement("div");u.classList.add("game__card"),u.dataset.id=c();const l=document.createElement("div");l.classList.add("game__card-back"),l.dataset.id=c();const o=document.createElement("div");o.classList.add("game__card-front"),o.dataset.id=c(),o.dataset.active=!0,((i,s)=>{if(typeof i===Object)for(let t of i)s.dataset.key=i[t]})({id:c(),active:!0},o);const p=document.createElement("div");p.classList.add("game__card-index-box");const b=document.createElement("div");b.classList.add("game__card-dignity"),b.textContent=i,b.dataset.id=c(),b.dataset.active=!0;const v=document.createElement("img");v.classList.add("game__card-suit"),v.src=s,v.dataset.id=c(),v.dataset.active=!0;const h=document.createElement("div");h.classList.add("game__card-dignity"),h.textContent=i;const y=document.createElement("img");y.classList.add("game__card-suit"),y.src=s;const f=document.createElement("img");f.classList.add("game__card-suit-big"),f.src=t,f.style.width="29",f.style.height="26",f.dataset.id=c(),f.dataset.active=!0;const I=document.createElement("div");I.classList.add("game__card-index-box","game__card-index-box__rotate"),o.appendChild(p),o.appendChild(f),o.appendChild(I),p.appendChild(b),p.appendChild(v),I.appendChild(h),I.appendChild(y),u.appendChild(l),u.appendChild(o),d.appendChild(u),a.appendChild(d),this.cardField=document.getElementById("card-field"),this.cardField.appendChild(a)}shuffleCards(i){for(let s=i.length-1;s>0;s--){let t=Math.floor(Math.random()*(s+1));[i[s],i[t]]=[i[t],i[s]]}return i}renderCard(){let s=i.templateCard;const t=Number(window.game.difficulty),e=this.cardsByDifficulty[t];s=this.shuffleCards(s),s=s.slice(0,e),s.push(...s),s=this.shuffleCards(s),s.forEach((i=>{this.createCard(i.dignity,i.suit.src,i.suit.srcBigIcon,i.suit.name)}))}}i.templateCard=[{dignity:"A",suit:{name:"spades",src:"./public/img/spades.svg",srcBigIcon:"./public/img/spades-big.svg"}},{dignity:"K",suit:{name:"spades",src:"./public/img/spades.svg",srcBigIcon:"./public/img/spades-big.svg"}},{dignity:"Q",suit:{name:"spades",src:"./public/img/spades.svg",srcBigIcon:"./public/img/spades-big.svg"}},{dignity:"J",suit:{name:"spades",src:"./public/img/spades.svg",srcBigIcon:"./public/img/spades-big.svg"}},{dignity:"10",suit:{name:"spades",src:"./public/img/spades.svg",srcBigIcon:"./public/img/spades-big.svg"}},{dignity:"9",suit:{name:"spades",src:"./public/img/spades.svg",srcBigIcon:"./public/img/spades-big.svg"}},{dignity:"8",suit:{name:"spades",src:"./public/img/spades.svg",srcBigIcon:"./public/img/spades-big.svg"}},{dignity:"7",suit:{name:"spades",src:"./public/img/spades.svg",srcBigIcon:"./public/img/spades-big.svg"}},{dignity:"6",suit:{name:"spades",src:"./public/img/spades.svg",srcBigIcon:"./public/img/spades-big.svg"}},{dignity:"A",suit:{name:"hearts",src:"./public/img/hearts.svg",srcBigIcon:"./public/img/hearts-big.svg"}},{dignity:"K",suit:{name:"hearts",src:"./public/img/hearts.svg",srcBigIcon:"./public/img/hearts-big.svg"}},{dignity:"Q",suit:{name:"hearts",src:"./public/img/hearts.svg",srcBigIcon:"./public/img/hearts-big.svg"}},{dignity:"J",suit:{name:"hearts",src:"./public/img/hearts.svg",srcBigIcon:"./public/img/hearts-big.svg"}},{dignity:"10",suit:{name:"hearts",src:"./public/img/hearts.svg",srcBigIcon:"./public/img/hearts-big.svg"}},{dignity:"9",suit:{name:"hearts",src:"./public/img/hearts.svg",srcBigIcon:"./public/img/hearts-big.svg"}},{dignity:"8",suit:{name:"hearts",src:"./public/img/hearts.svg",srcBigIcon:"./public/img/hearts-big.svg"}},{dignity:"7",suit:{name:"hearts",src:"./public/img/hearts.svg",srcBigIcon:"./public/img/hearts-big.svg"}},{dignity:"6",suit:{name:"hearts",src:"./public/img/hearts.svg",srcBigIcon:"./public/img/hearts-big.svg"}},{dignity:"A",suit:{name:"diamonds",src:"./public/img/diamonds.svg",srcBigIcon:"./public/img/diamonds-big.svg"}},{dignity:"K",suit:{name:"diamonds",src:"./public/img/diamonds.svg",srcBigIcon:"./public/img/diamonds-big.svg"}},{dignity:"Q",suit:{name:"diamonds",src:"./public/img/diamonds.svg",srcBigIcon:"./public/img/diamonds-big.svg"}},{dignity:"J",suit:{name:"diamonds",src:"./public/img/diamonds.svg",srcBigIcon:"./public/img/diamonds-big.svg"}},{dignity:"10",suit:{name:"diamonds",src:"./public/img/diamonds.svg",srcBigIcon:"./public/img/diamonds-big.svg"}},{dignity:"9",suit:{name:"diamonds",src:"./public/img/diamonds.svg",srcBigIcon:"./public/img/diamonds-big.svg"}},{dignity:"8",suit:{name:"diamonds",src:"./public/img/diamonds.svg",srcBigIcon:"./public/img/diamonds-big.svg"}},{dignity:"7",suit:{name:"diamonds",src:"./public/img/diamonds.svg",srcBigIcon:"./public/img/diamonds-big.svg"}},{dignity:"6",suit:{name:"diamonds",src:"./public/img/diamonds.svg",srcBigIcon:"./public/img/diamonds-big.svg"}},{dignity:"A",suit:{name:"clubs",src:"./public/img/clubs.svg",srcBigIcon:"./public/img/clubs-big.svg"}},{dignity:"K",suit:{name:"clubs",src:"./public/img/clubs.svg",srcBigIcon:"./public/img/clubs-big.svg"}},{dignity:"Q",suit:{name:"clubs",src:"./public/img/clubs.svg",srcBigIcon:"./public/img/clubs-big.svg"}},{dignity:"J",suit:{name:"clubs",src:"./public/img/clubs.svg",srcBigIcon:"./public/img/clubs-big.svg"}},{dignity:"10",suit:{name:"clubs",src:"./public/img/clubs.svg",srcBigIcon:"./public/img/clubs-big.svg"}},{dignity:"9",suit:{name:"clubs",src:"./public/img/clubs.svg",srcBigIcon:"./public/img/clubs-big.svg"}},{dignity:"8",suit:{name:"clubs",src:"./public/img/clubs.svg",srcBigIcon:"./public/img/clubs-big.svg"}},{dignity:"7",suit:{name:"clubs",src:"./public/img/clubs.svg",srcBigIcon:"./public/img/clubs-big.svg"}},{dignity:"6",suit:{name:"clubs",src:"./public/img/clubs.svg",srcBigIcon:"./public/img/clubs-big.svg"}}],sessionStorage.getItem("status")||sessionStorage.setItem("status","start"),window.game={status:sessionStorage.getItem("status"),difficulty:"1",cards:[]};const s=new i;new class{container=document.getElementById("container");clickCount=0;compare=[];constructor(){document.getElementById("start-game").addEventListener("click",(i=>{i.preventDefault(),this.checkDifficulty(i)})),this.container.addEventListener("click",(i=>{this.cardClickHandler(i.target)}))}checkDifficulty({target:i}){document.getElementById("difficulty-field").childNodes.forEach((i=>{"radio"===i.type&&i.checked&&(window.game.difficulty=i.value)})),s.startGame(i)}cardClickHandler(i){if(i.dataset.id){if(i.dataset.active)return;this.clickCount++,document.getElementById(i.dataset.id).classList.toggle("flip"),i.dataset.active=!0;const s=window.game.cards.indexOf(i.dataset.id);if(-1===s)return;window.game.cards.splice(s,1),this.compare.push(i.dataset.id),this.checkResult()}}checkResult(){const[i,s]=this.compare;2===this.clickCount&&(s.startsWith(i)||i.startsWith(s)?this.clickCount=0:setTimeout((()=>{alert("Вы проиграли")}),100),this.clickCount=0,this.compare=[]),window.game.cards.length||setTimeout((()=>{alert("Вы победили!")}),500)}}})();