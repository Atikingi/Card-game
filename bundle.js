(()=>{"use strict";var i=function(){function i(){this.container=document.getElementById("container"),this.cardsByDifficulty=[3,6,12],this.difficultyForm=null,this.templateItem=null,this.clone=null,this.gameScreen=null,this.resultScreen=null,this.cardField=null}return i.prototype.checkGameStatus=function(){"start"===window.game.status&&(this.renderScreen("template-difficulty"),this.difficultyForm=document.getElementById("difficulty-form"),this.difficultyForm&&this.difficultyForm.classList.remove("game__difficulty_hidden")),"game"===window.game.status&&this.renderScreen("template-difficulty")},i.prototype.renderScreen=function(i){this.templateItem=document.getElementById(i),this.templateItem&&this.templateItem instanceof HTMLTemplateElement&&(this.clone=this.templateItem.content.cloneNode(!0)),this.container&&this.clone&&this.container.appendChild(this.clone)},i.prototype.startGame=function(){this.difficultyForm=document.getElementById("difficulty-form"),this.difficultyForm&&this.difficultyForm.classList.add("game__difficulty_hidden"),window.game.status="game",this.renderScreen("template-game"),this.renderCard()},i.prototype.renderResultScreen=function(){this.renderScreen("template-result")},i.prototype.restartGame=function(){window.game.status,this.difficultyForm=document.getElementById("difficulty-form"),this.difficultyForm&&this.difficultyForm.classList.remove("game__difficulty_hidden"),this.gameScreen=document.getElementById("screen-game"),this.resultScreen=document.getElementById("screen-result"),"game"===window.game.status&&this.gameScreen&&(this.gameScreen.remove(),this.resultScreen&&this.resultScreen.remove())},i.prototype.createCard=function(i,t,e,s){var c=function(){var t=s+i;return document.getElementById(t)?t+"double":t},n=function(i,t){var e;1===i.length&&t?t.classList.add(i[0]):t&&(e=t.classList).add.apply(e,i)},a=function(i,t){for(var e in i)t&&(t.dataset[e]=i[e])},r=function(i,t){t.src=i},d=function(i,t){t&&(t.textContent=i)};window.game.cards.push(c());var g,u,m=document.createDocumentFragment(),l=document.createElement("div");n(["game__card-wrapper","flip"],l),a({dignity:i,suit:s},l),g=l,u=c(),g&&(g.id=u),setTimeout((function(){l.classList.remove("flip")}),5e3);var o=document.createElement("div");n(["game__card"],o),a({id:c()},o);var p=document.createElement("div");n(["game__card-back"],p),a({id:c()},p);var h=document.createElement("div");n(["game__card-front"],h),a({id:c(),active:"true"},h);var b=document.createElement("div");n(["game__card-index-box"],b);var v=document.createElement("div");n(["game__card-dignity"],v),d(i,v),a({id:c(),active:"true"},v);var f=document.createElement("img");n(["game__card-suit"],f),r(t,f),a({id:c(),active:"true"},f);var y=document.createElement("div");n(["game__card-dignity"],y),d(i,y);var I=document.createElement("img");n(["game__card-suit"],I),r(t,I);var B=document.createElement("img");n(["game__card-suit-big"],B),r(e,B),function(i,t){for(var e in i)t&&(t.dataset[e]=i[e])}({width:"29",height:"26"},B),a({id:c(),active:"true"},B);var w=document.createElement("div");w.classList.add("game__card-index-box","game__card-index-box__rotate"),h.appendChild(b),h.appendChild(B),h.appendChild(w),b.appendChild(v),b.appendChild(f),w.appendChild(y),w.appendChild(I),o.appendChild(p),o.appendChild(h),l.appendChild(o),m.appendChild(l),this.cardField=document.getElementById("card-field"),this.cardField&&this.cardField.appendChild(m)},i.prototype.shuffleCards=function(i){for(var t,e=i.length-1;e>0;e--){var s=Math.floor(Math.random()*(e+1));t=[i[s],i[e]],i[e]=t[0],i[s]=t[1]}return i},i.prototype.renderCard=function(){var t=this,e=i.templateCard,s=Number(window.game.difficulty),c=this.cardsByDifficulty[s],n=this.shuffleCards(e);(n=n.slice(0,c)).push.apply(n,n),(n=this.shuffleCards(n)).forEach((function(i){t.createCard(i.dignity,i.suit.src,i.suit.srcBigIcon,i.suit.name)}))},i}();const t=i;i.templateCard=[{dignity:"A",suit:{name:"spades",src:"./public/img/spades.svg",srcBigIcon:"./public/img/spades-big.svg"}},{dignity:"K",suit:{name:"spades",src:"./public/img/spades.svg",srcBigIcon:"./public/img/spades-big.svg"}},{dignity:"Q",suit:{name:"spades",src:"./public/img/spades.svg",srcBigIcon:"./public/img/spades-big.svg"}},{dignity:"J",suit:{name:"spades",src:"./public/img/spades.svg",srcBigIcon:"./public/img/spades-big.svg"}},{dignity:"10",suit:{name:"spades",src:"./public/img/spades.svg",srcBigIcon:"./public/img/spades-big.svg"}},{dignity:"9",suit:{name:"spades",src:"./public/img/spades.svg",srcBigIcon:"./public/img/spades-big.svg"}},{dignity:"8",suit:{name:"spades",src:"./public/img/spades.svg",srcBigIcon:"./public/img/spades-big.svg"}},{dignity:"7",suit:{name:"spades",src:"./public/img/spades.svg",srcBigIcon:"./public/img/spades-big.svg"}},{dignity:"6",suit:{name:"spades",src:"./public/img/spades.svg",srcBigIcon:"./public/img/spades-big.svg"}},{dignity:"A",suit:{name:"hearts",src:"./public/img/hearts.svg",srcBigIcon:"./public/img/hearts-big.svg"}},{dignity:"K",suit:{name:"hearts",src:"./public/img/hearts.svg",srcBigIcon:"./public/img/hearts-big.svg"}},{dignity:"Q",suit:{name:"hearts",src:"./public/img/hearts.svg",srcBigIcon:"./public/img/hearts-big.svg"}},{dignity:"J",suit:{name:"hearts",src:"./public/img/hearts.svg",srcBigIcon:"./public/img/hearts-big.svg"}},{dignity:"10",suit:{name:"hearts",src:"./public/img/hearts.svg",srcBigIcon:"./public/img/hearts-big.svg"}},{dignity:"9",suit:{name:"hearts",src:"./public/img/hearts.svg",srcBigIcon:"./public/img/hearts-big.svg"}},{dignity:"8",suit:{name:"hearts",src:"./public/img/hearts.svg",srcBigIcon:"./public/img/hearts-big.svg"}},{dignity:"7",suit:{name:"hearts",src:"./public/img/hearts.svg",srcBigIcon:"./public/img/hearts-big.svg"}},{dignity:"6",suit:{name:"hearts",src:"./public/img/hearts.svg",srcBigIcon:"./public/img/hearts-big.svg"}},{dignity:"A",suit:{name:"diamonds",src:"./public/img/diamonds.svg",srcBigIcon:"./public/img/diamonds-big.svg"}},{dignity:"K",suit:{name:"diamonds",src:"./public/img/diamonds.svg",srcBigIcon:"./public/img/diamonds-big.svg"}},{dignity:"Q",suit:{name:"diamonds",src:"./public/img/diamonds.svg",srcBigIcon:"./public/img/diamonds-big.svg"}},{dignity:"J",suit:{name:"diamonds",src:"./public/img/diamonds.svg",srcBigIcon:"./public/img/diamonds-big.svg"}},{dignity:"10",suit:{name:"diamonds",src:"./public/img/diamonds.svg",srcBigIcon:"./public/img/diamonds-big.svg"}},{dignity:"9",suit:{name:"diamonds",src:"./public/img/diamonds.svg",srcBigIcon:"./public/img/diamonds-big.svg"}},{dignity:"8",suit:{name:"diamonds",src:"./public/img/diamonds.svg",srcBigIcon:"./public/img/diamonds-big.svg"}},{dignity:"7",suit:{name:"diamonds",src:"./public/img/diamonds.svg",srcBigIcon:"./public/img/diamonds-big.svg"}},{dignity:"6",suit:{name:"diamonds",src:"./public/img/diamonds.svg",srcBigIcon:"./public/img/diamonds-big.svg"}},{dignity:"A",suit:{name:"clubs",src:"./public/img/clubs.svg",srcBigIcon:"./public/img/clubs-big.svg"}},{dignity:"K",suit:{name:"clubs",src:"./public/img/clubs.svg",srcBigIcon:"./public/img/clubs-big.svg"}},{dignity:"Q",suit:{name:"clubs",src:"./public/img/clubs.svg",srcBigIcon:"./public/img/clubs-big.svg"}},{dignity:"J",suit:{name:"clubs",src:"./public/img/clubs.svg",srcBigIcon:"./public/img/clubs-big.svg"}},{dignity:"10",suit:{name:"clubs",src:"./public/img/clubs.svg",srcBigIcon:"./public/img/clubs-big.svg"}},{dignity:"9",suit:{name:"clubs",src:"./public/img/clubs.svg",srcBigIcon:"./public/img/clubs-big.svg"}},{dignity:"8",suit:{name:"clubs",src:"./public/img/clubs.svg",srcBigIcon:"./public/img/clubs-big.svg"}},{dignity:"7",suit:{name:"clubs",src:"./public/img/clubs.svg",srcBigIcon:"./public/img/clubs-big.svg"}},{dignity:"6",suit:{name:"clubs",src:"./public/img/clubs.svg",srcBigIcon:"./public/img/clubs-big.svg"}}],sessionStorage.getItem("status")||sessionStorage.setItem("status","start"),window.game={status:sessionStorage.getItem("status"),difficulty:"1",cards:[],timer:[]};var e=new t;const s=function(){function i(){var i=this;this.container=document.getElementById("container"),this.startGameButton=document.getElementById("start-game"),this.clickCount=0,this.compare=[],this.resultStatus=null,this.resultIcon=null,this.resultTime=null,this.timerValue=null,this.startGameButton.addEventListener("click",(function(t){t.preventDefault(),t.target&&i.checkDifficulty()})),this.container.addEventListener("click",(function(t){var e=t.target;i.cardClickHandler(e),i.restartGame(e)}))}return i.prototype.checkDifficulty=function(){var i=document.getElementById("difficulty-field");i&&i.childNodes.forEach((function(i){"radio"===i.type&&i.checked&&(window.game.difficulty=i.value)})),e.startGame(),this.timer()},i.prototype.cardClickHandler=function(i){if(i&&i.dataset.id){if(i.dataset.active)return;this.clickCount++;var t=document.getElementById(i.dataset.id);t&&(t.classList.toggle("flip"),i.dataset.active="true");var e=window.game.cards.indexOf(i.dataset.id);if(-1===e)return;window.game.cards.splice(e,1),this.compare.push(i.dataset.id),this.checkResult()}},i.prototype.checkResult=function(){var i=this,t=this.compare,s=t[0],c=t[1];2===this.clickCount&&(c.startsWith(s)||s.startsWith(c)?this.clickCount=0:setTimeout((function(){e.renderResultScreen(),i.stopTimer(),i.showLostResult()}),100),this.clickCount=0,this.compare=[]),window.game.cards.length||setTimeout((function(){e.renderResultScreen(),i.stopTimer(),i.showWinResult()}),500)},i.prototype.restartGame=function(i){i&&"restart"===i.id&&(e.restartGame(),window.game.cards=[])},i.prototype.timer=function(){var i=document.getElementById("timer");setTimeout((function(){var t=new Date;window.game.timer.push(setInterval((function(){return e=(new Date).getTime()-t.getTime(),void(i&&(i.innerHTML=new Date(e).toISOString().slice(14,19)));var e}),500))}),5e3)},i.prototype.stopTimer=function(){window.game.timer.map((function(i){return clearInterval(i)})),window.game.timer=[]},i.prototype.showLostResult=function(){this.resultStatus=document.getElementById("result-status"),this.resultIcon=document.getElementById("result-icon"),this.resultTime=document.getElementById("result-time"),this.timerValue=document.getElementById("timer"),this.resultStatus&&this.resultIcon&&(this.resultStatus.textContent="Вы проиграли!",this.resultIcon.src="../public/img/lost.svg"),this.resultTime&&this.timerValue&&(this.resultTime.textContent=this.timerValue.textContent)},i.prototype.showWinResult=function(){this.resultTime=document.getElementById("result-time"),this.timerValue=document.getElementById("timer"),this.resultTime&&this.timerValue&&(this.resultTime.textContent=this.timerValue.textContent)},i}();e.checkGameStatus(),new t,new s})();